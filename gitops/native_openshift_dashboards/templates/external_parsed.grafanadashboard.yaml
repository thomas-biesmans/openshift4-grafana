---
{{- range $json_report := .Values.external_jsons }}
{{ "#" }} Per: {{ $json_report.url }}
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: {{ $json_report.name }}
  namespace: {{ $.Values.namespace_to_deploy_grafana_and_dashboards }}
spec:
  folder: {{ $json_report.folder }}
  instanceSelector:
    matchLabels:
      dashboards: {{ $.Values.grafana_dashboard_name }}
  datasources:
  - datasourceName: Prometheus
    inputName: DS_PROMETHEUS
  json: | {{ "\n" }}
{{- $json_transformed := $json_report.json -}}
{{- range $replacement_operation := $json_report.replacement_operations -}}
{{- $json_transformed = $json_transformed | replace $replacement_operation.from $replacement_operation.to -}}
{{- end -}}
{{ $json_transformed | indent 4 }}
{{- end -}}